"0","modifyWeek <- function(dataframe){"
"0","#Modifies week variable from a string to a number"
"0","  modifiedData <- dataframe"
"0","  week <- dataframe$`Week`"
"0","  "
"0","  weekNum <- extract_numeric(week)"
"0","  wildcard <- grepl(""Wild"",week)"
"0","  division <- grepl(""Divisional"",week)"
"0","  conference <- grepl(""Conference"",week)"
"0","  super <- grepl(""Super"",week)"
"0","  for(i in 1:length(weekNum)){"
"0","    if(is.na(weekNum[i])){"
"0","      if(wildcard[i]){"
"0","        weekNum[i] <- 18"
"0","      } else if(division[i]){"
"0","        weekNum[i]<-19"
"0","      } else if(conference[i]){"
"0","        weekNum[i]<-20"
"0","      } else if(super[i]){"
"0","        weekNum[i] <-21"
"0","      }"
"0","    }"
"0","  }"
"0","  "
"0","  modifiedData$`Week` <- weekNum"
"0","  return(modifiedData)"
"0","}"
"0","simplify <- function(dataframe){"
"0","#Modifies the full dataset to only include columns of interest"
"0"," "
"0","   modifiedData <- dataframe %>%  "
"0","    select(Date:Home_Points,contains('Home_Net Yards Rushing'):contains('Home_Avg. Yds/Att'),Away_Team,Away_Points,contains('Away_Net Yards Rushing'):contains('Away_Avg. Yds/Att'),-contains('Home_Sacked'):-contains('Home_Gross'),-contains('Away_Sacked'):-contains('Away_Gross')) %>%"
"0","    separate(`Away_Att - Comp - Int`,c('Away_Att','Away_Comp','Away_Int')) %>%"
"0","    separate(`Home_Att - Comp - Int`,c('Home_Att','Home_Comp','Home_Int')) %>%"
"0","    select(-`Home_Comp`,-`Home_Int`,-`Away_Comp`,-`Away_Int`) "
"0"," "
"0","  "
"0","  #Converts vectors that are not numbers to characters"
"0","  modifiedData[,c(1,3,11)] <- data.frame(apply(modifiedData[,c(1,3,11)], 2, as.factor))"
"0","  modifiedData[,c(1,3,11)] <- data.frame(apply(modifiedData[,c(1,3,11)], 2, as.character))"
"0","  "
"0","  #Converts vectors that contain numbers to type double"
"0","  numVectors = (1:ncol(modifiedData))[-c(1,2,3,11)]"
"0","  modifiedData[,numVectors] <- data.frame(apply(modifiedData[,numVectors], 2, as.factor))"
"0","  modifiedData[,numVectors] <- data.frame(apply(modifiedData[,numVectors], 2, as.numeric))"
"0","  "
"0","  "
"0","  "
"0","  "
"0","  #Adjust Average Passing Yards/Attempt Stat to Net yards, not Gross yards"
"0","  modifiedData$`Home_Pass Gain/Att` = modifiedData$`Home_Net Yards Passing`/modifiedData$`Home_Att`"
"0","  modifiedData$`Away_Pass Gain/Att` = modifiedData$`Away_Net Yards Passing`/modifiedData$`Away_Att`"
"0","  "
"0","  modifiedData <- modifyWeek(modifiedData)"
"0","  modifiedData <- modifiedData[,c(1:9,19,11:17,20,10,18)]"
"0","  modifiedData <- modifiedData[,-c(19,20)]"
"0","  "
"0","  modifiedData <- modifiedData %>%"
"0","    mutate_each_( funs(as.character(.)), names( .[,sapply(., is.factor)] ))"
"0","  return(modifiedData)"
"0","}"
