"0","createModelDF <- function(rawDataframe, prevYearRawDataframe){"
"0","  game_data <- simplify(rawDataframe)"
"0","  "
"0","  "
"0","  OD_dataframe <- createODDF(rawDataframe) %>%"
"0","      select(Week,Team,contains(""O_""),contains(""D_""))"
"0","  "
"0","  prev_OD_dataframe <- createODDF(prevYearRawDataframe) %>%"
"0","    select(Week,Team,contains(""Points"")) %>%"
"0","    filter(Week>20) %>%"
"0","    rename(`O_Points_Last_Year` = O_Points) %>%"
"0","    rename(`D_Points_Last_Year` = D_Points) %>%"
"0","    select(-Week)    "
"0","  "
"0","  "
"0","  OD_dataframe$Team = as.character(OD_dataframe$Team)"
"0","  prev_OD_dataframe$Team = as.character(prev_OD_dataframe$Team)"
"0","  "
"0","  #Account for team name changes"
"0","  "
"0","  "
"0","  oldTeam = c(""St. Louis"",""Los Angeles"",""San Diego"")"
"0","  newTeam = c(""Los Angeles"",""LA Rams"",""LA Chargers"")"
"0","  for(i in 1:length(oldTeam)){"
"0","    game_data[ game_data == oldTeam[i] ] <- newTeam[i]"
"0","    OD_dataframe[OD_dataframe==oldTeam[i]]<- newTeam[i]"
"0","    prev_OD_dataframe[prev_OD_dataframe==oldTeam[i]]<-newTeam[i]"
"0","  }"
"0","  "
"0","  "
"0","  "
"0","  game_id = data.frame(1:nrow(game_data))"
"0","  "
"0","  team_names <- game_data %>%"
"0","    group_by(Home_Team) %>%"
"0","    summarise() "
"0","  "
"0","  colnames(team_names)<- ""Team"""
"0","  "
"0","  team_id = data.frame(1:nrow(team_names))"
"0","  "
"0","  team_ids <- bind_cols(team_names,team_id)"
"0","  home_ids <- team_ids "
"0","  colnames(home_ids)[2] = ""Home_id"""
"0","  away_ids <- team_ids"
"0","  colnames(away_ids)[2] = ""Away_id"""
"0","  game_data <- game_data %>%"
"0","    left_join(home_ids,by = c(""Home_Team"" = ""Team"")) %>%"
"0","    left_join(away_ids,by = c(""Away_Team""= ""Team"")) %>% "
"0","    select(Date,Week,Home_Team,Home_id,Home_Points,Away_Team,Away_id,Away_Points)"
"0","  "
"0","  "
"0","  "
"0","  "
"0","  H_data <- OD_dataframe "
"0","  A_data <- OD_dataframe"
"0","  "
"0","  H_prev <- prev_OD_dataframe"
"0","  A_prev <- prev_OD_dataframe"
"0","  "
"0","  colnames(H_data)[1:ncol(H_data)] <- paste0(""Home_"",colnames(H_data)[1:ncol(H_data)])"
"0","  colnames(A_data)[1:ncol(A_data)] <- paste0(""Away_"",colnames(A_data)[1:ncol(A_data)])"
"0","  "
"0","  colnames(H_prev)[1:ncol(H_prev)] <- paste0(""Home_"",colnames(H_prev)[1:ncol(H_prev)])"
"0","  colnames(A_prev)[1:ncol(A_prev)] <- paste0(""Away_"",colnames(A_prev)[1:ncol(A_prev)])"
"0","  "
"0","  "
"0","  game_data <- game_data %>%"
"0","    bind_cols(game_id) %>%"
"0","    left_join(H_data,by = c(""Week"" = ""Home_Week"", ""Home_Team""=""Home_Team"")) %>%"
"0","    left_join(H_prev,by = c(""Home_Team""=""Home_Team"")) %>%"
"0","    left_join(A_data,by = c(""Week"" = ""Away_Week"", ""Away_Team""=""Away_Team"")) %>%"
"0","    left_join(A_prev,by = c(""Away_Team""=""Away_Team"")) %>%"
"0","    select(Date,Week,contains(""Home_""),contains(""Away_"")) %>%"
"0","    filter(Week >3) %>%"
"0","    arrange(Week,Home_Team)"
"0","  "
"0","  binnedWeeks <- rep(0, nrow(game_data))"
"0","  weeks <- game_data$Week"
"0","  # for(i in 1:length(weeks)){"
"0","  #   if(weeks[i]>=1 & weeks[i]<=5){"
"0","  #     binnedWeeks[i]=1"
"0","  #   } else if(weeks[i]>=6 & weeks[i]<=10){"
"0","  #     binnedWeeks[i] = 2"
"0","  #   } else if(weeks[i]>=11 & weeks[i] <=14){"
"0","  #     binnedWeeks[i] = 3"
"0","  #   } else{"
"0","  #     binnedWeeks[i] = 4"
"0","  #   }"
"0","  # }"
"0","  "
"0","  for(i in 1:length(weeks)){"
"0","    if(weeks[i]>=1 & weeks[i]<=5){"
"0","      binnedWeeks[i] = 1"
"0","    } else if(weeks[i]>=5 & weeks[i] <=10){"
"0","      binnedWeeks[i] = 2"
"0","    } else{"
"0","      binnedWeeks[i] = 3"
"0","    }"
"0","  }"
"0","  binnedWeeks <-data.frame(binnedWeeks)"
"0","  colnames(binnedWeeks)<- ""binnedWeeks"""
"0","  "
"0","  game_data <- bind_cols(game_data,binnedWeeks)"
"0","  "
"0","  return(game_data)"
"0","}"
"0","# View(createModelDF(game_stats_2016,game_stats_2015))"
"0","# View(createModelDF(game_stats_2015,game_stats_2014))"
