"0","set.seed(13)"
"0","single_prediction <- function(modelDFRow, predictionsDF){"
"0","  home_impact = predictionsDF[,modelDFRow$Home_id + 8] "
"0","  if(modelDFRow$Week ==21){"
"0","    home_impact = 0"
"0","  }"
"0","  "
"0","  home_pred = rpois(10000, home_impact+ exp(predictionsDF$b0 + predictionsDF[,modelDFRow$binnedWeek + 2]*(modelDFRow$`Home_O_Points` - modelDFRow$`Away_D_Points`) + predictionsDF[,modelDFRow$binnedWeek + 5]*(modelDFRow$`Home_O_Points_Last_Year` - modelDFRow$`Away_D_Points_Last_Year`)))"
"0","  "
"0","  away_pred = rpois(10000,exp(predictionsDF$b0 + predictionsDF[,modelDFRow$binnedWeek + 2]*(modelDFRow$`Away_O_Points` - modelDFRow$`Home_D_Points`) + predictionsDF[,modelDFRow$binnedWeek + 5]*(modelDFRow$`Away_O_Points_Last_Year` - modelDFRow$`Home_D_Points_Last_Year`)))"
"0","  "
"0","  return(list(score_diff = home_pred - away_pred, total_pts = home_pred + away_pred))           "
"0","}"
"0","all_predictions <- function(data, sampleDF){"
"0","  score_diff_predictions = rep(0,nrow(data))"
"0","  total_points_predictions = rep(0,nrow(data))"
"0","  for(i in 1:nrow(data)){"
"0","    prediction = single_prediction(data[i,],sampleDF)"
"0","    score_diff_predictions[i] = round(mean(prediction$score_diff))"
"0","    total_points_predictions[i] = round(mean(prediction$total_pts))"
"0","  }"
"0","  predictionsDF = data.frame(score_diff_predictions,total_points_predictions)"
"0","  newDF = bind_cols(data,predictionsDF)"
"0","  return(newDF)"
"0","}"
