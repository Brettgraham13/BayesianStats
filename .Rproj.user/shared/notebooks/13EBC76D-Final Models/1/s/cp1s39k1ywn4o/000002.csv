"0","set.seed(13)"
"0","predictScoreDiff <- function(modelDFRow){"
"0","  predictions = "
"0","    rpois(10000,exp(score_diff_sample$h0 + score_diff_sample$b0 + score_diff_sample$b1*modelDFRow$Home_O_Points + score_diff_sample$b2*modelDFRow$Away_D_Points + rnorm(score_diff_sample[,modelDFRow$Home_id + 6], sqrt(1/score_diff_sample$tau)))) - "
"0","    rpois(10000, exp(score_diff_sample$b0 + score_diff_sample$b1*modelDFRow$Away_O_Points + score_diff_sample$b2*modelDFRow$Home_D_Points + rnorm(score_diff_sample[,modelDFRow$Away_id + 6],sqrt(1/score_diff_sample$tau))))"
"0","}"
"0","comparePrediction <- function(modelDF){"
"0","  accuracyVect = rep(0,nrow(modelDF))"
"0","  for(i in 1:nrow(modelDF)){"
"0","    scoreDiff = modelDF$Home_Points[i] - modelDF$Away_Points[i]"
"0","    predictionsDF = data.frame(predictScoreDiff(modelDF[i,])) "
"0","    meanPredictions = round(mean(predictionsDF[,1]))"
"0","    accuracyVect[i] = round(scoreDiff - meanPredictions)"
"0","  }"
"0","  accuracyDF = data.frame(accuracyVect,abs(accuracyVect))"
"0","  colnames(accuracyDF)<- c(""Prediction Accuracy"",""Error"")"
"0","  return(accuracyDF)"
"0","}"
